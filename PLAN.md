# План реализации минимального сервиса хостинга изображений на Go

## Фаза 1: Создание базовой структуры проекта

- [x] Создать директорию `/app`
- [x] Создать файл `app/main.go` с базовой структурой приложения
- [x] Создать файл `app/handlers.go` с заготовками обработчиков HTTP
- [x] Создать файл `app/storage.go` с заготовками функций хранения
- [x] Создать файл `app/cleanup.go` с заготовками функций очистки
- [x] Создать директорию `app/templates`
- [x] Создать файл `app/templates/index.html` с базовой структурой главной страницы
- [x] Создать файл `app/templates/album.html` с базовой структурой страницы альбома
- [x] Создать файл `Dockerfile` для сборки приложения
- [x] Создать файл `docker-compose.yml` для развертывания

## Фаза 2: Реализация минимального HTTP backend

- [x] Реализовать минимальный HTTP сервер в `main.go`
- [x] Настроить маршрутизацию только требуемых эндпоинтов
- [x] Настроить сервер на прослушивание 0.0.0.0:8000
- [x] Исключить логирование, статическую раздачу файлов и graceful shutdown

## Фаза 3: Frontend minimal UI

- [x] Реализовать шаблон index.html с drag & drop зоной загрузки
- [x] Реализовать шаблон album.html с отображением изображений
- [x] Добавить минимальный CSS для улучшения внешнего вида
- [x] Добавить минимальный JavaScript для drag & drop загрузки

## Фаза 4: Реализация системы хранения изображений

- [x] Добавить функциональность копирования URL изображений
- [x] Реализовать функции сохранения файлов в `storage.go`
- [x] Создать систему генерации уникальных имен файлов
- [x] Реализовать валидацию типов изображений (jpg, png, gif, webp)
- [x] Добавить ограничение на размер загружаемых файлов
- [x] Реализовать создание директории `/data` при запуске
- [x] Добавить функции получения метаданных изображения

## Фаза 5: Реализация страницы альбома

- [ ] Реализовать обработчик загрузки изображения в `handlers.go`
- [ ] Добавить обработку multipart/form-data запросов
- [ ] Реализовать сжатие изображений после загрузки
- [ ] Реализовать сохранение загруженных файлов в файловую систему
- [ ] Добавить установку анонимных cookie для идентификации сессии
- [ ] Реализовать перенаправление на страницу альбома после загрузки
- [ ] Добавить обработку ошибок загрузки

## Фаза 6: Реализация страницы альбома

- [ ] Реализовать обработчик страницы альбома в `handlers.go`
- [ ] Создать функцию получения списка изображений пользователя по cookie
- [ ] Реализовать отображение изображений в сетке на странице альбома
- [ ] Добавить возможность копирования URL изображений
- [ ] Добавить навигацию между страницами при большом количестве изображений

## Фаза 7: Реализация системы очистки

- [ ] Реализовать функцию очистки старых изображений в `cleanup.go`
- [ ] Добавить определение "старых" изображений на основе времени последнего доступа
- [ ] Реализовать периодическую очистку в отдельной goroutine
- [ ] Добавить очистку пустых директорий
- [ ] Реализовать graceful остановку процесса очистки

## Фаза 8: Финализация и тестирование

- [ ] Добавить обработку всех возможных ошибок
- [ ] Проверить соответствие всем правилам проекта
- [ ] Оптимизировать HTML шаблоны для минимального размера
- [ ] Добавить базовый CSS для улучшения внешнего вида
- [ ] Добавить минимальный JavaScript для drag & drop загрузки
- [ ] Протестировать работу приложения в Docker контейнере
- [ ] Проверить работу всех эндпоинтов и функциональности
