<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–•–æ—Å—Ç–∏–Ω–≥ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π</title>
<style>
body{font-family:Arial,sans-serif;max-width:800px;margin:0 auto;padding:20px;background:#121212;color:#ffffff}
h1{color:#ffffff;text-align:center}
.upload-container{margin:30px 0}
.upload-area{border:3px dashed #555;border-radius:10px;padding:40px;text-align:center;margin:20px 0;background:#2d2d2d;cursor:pointer}
.upload-area:hover{border-color:#777;background:#3d3d3d}
.upload-area.dragover{border-color:#4CAF50;background:#2e4d2e}
.upload-icon{font-size:48px;color:#777;margin-bottom:15px}
.upload-text{font-size:18px;color:#cccccc;margin-bottom:15px}
.upload-hint{font-size:14px;color:#999}
form{margin-top:20px}
input[type="file"]{display:none}
.albums-container{margin:30px 0}
.albums-title{font-size:20px;color:#ffffff;margin-bottom:15px}
.albums-list{display:flex;flex-direction:column;gap:15px}
.album-item{border:1px solid #555;border-radius:8px;padding:15px;background:#2d2d2d;text-align:center}
.album-link:hover .album-item{background:#3d3d3d}
.album-link{text-decoration:none;color:#ffffff}
.album-link:hover{color:#ffffff}
.album-count{font-size:14px;color:#cccccc;margin-top:5px}
.delete-user-btn{background:#d32f2f;color:white;border:none;padding:8px 16px;border-radius:4px;cursor:pointer;font-size:14px}
.delete-user-btn:hover{background:#b71c1c}
</style>
</head>
<body>
<h1>–•–æ—Å—Ç–∏–Ω–≥ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π</h1>
<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
	<p>–ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –æ–±–º–µ–Ω–∞</p>
	<button type="button" class="delete-user-btn" onclick="deleteUser()">–£–¥–∞–ª–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</button>
</div>

<div class="upload-container">
<div class="upload-area" id="uploadArea">
<div class="upload-icon">üìÅ</div>
<div class="upload-text">–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—é–¥–∞</div>
<div class="upload-hint">–∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–æ–≤</div>
</div>
<form action="/upload" method="post" enctype="multipart/form-data" id="uploadForm">
<input type="file" name="image" accept="image/*" multiple id="fileInput">
</form>
</div>

<!-- –°–ø–∏—Å–æ–∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∞–ª—å–±–æ–º–æ–≤ -->
{{if .HasAlbums}}
<div class="albums-container">
<div class="albums-title">–í–∞—à–∏ –∞–ª—å–±–æ–º—ã</div>
<div class="albums-list">
{{range .Albums}}
<a href="/{{$.SessionID}}/{{.ID}}" class="album-link" style="text-decoration:none;display:block;">
	<div class="album-item">
		<div style="font-weight:bold;color:#333;">{{.Name}}</div>
		<div class="album-count">{{.ImageCount}} –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π</div>
		<div class="album-count">–°–æ–∑–¥–∞–Ω: {{.CreatedAt.Format "02.01.2006 15:04"}}</div>
	</div>
</a>
{{end}}
</div>
</div>
{{end}}

<script>
document.addEventListener('DOMContentLoaded',function(){
const uploadArea=document.getElementById('uploadArea');
const fileInput=document.getElementById('fileInput');
const uploadForm=document.getElementById('uploadForm');
uploadArea.addEventListener('click',function(){fileInput.click()});
fileInput.addEventListener('change',function(){
if(fileInput.files.length>0){
uploadForm.submit();
}
});
uploadArea.addEventListener('dragover',function(e){e.preventDefault();uploadArea.classList.add('dragover')});
uploadArea.addEventListener('dragleave',function(e){e.preventDefault();uploadArea.classList.remove('dragover')});
uploadArea.addEventListener('drop',function(e){
e.preventDefault();uploadArea.classList.remove('dragover');
const files=e.dataTransfer.files;
if(files.length>0){
fileInput.files=files;
uploadForm.submit();
}
});
});

function deleteUser(){
	if(!confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –≤–µ—Å—å –ø—Ä–æ—Ñ–∏–ª—å —Å–æ –≤—Å–µ–º–∏ –∞–ª—å–±–æ–º–∞–º–∏ –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ!')){
		return;
	}
	
	fetch('/delete-user',{
		method:'POST'
	})
	.then(response=>{
		if(response.ok){
			// –£–¥–∞–ª—è–µ–º cookie –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
			document.cookie = 'session_id=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;';
			// –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–æ–≤–æ–π —Å–µ—Å—Å–∏–∏
			window.location.reload();
		}else{
			alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –ø—Ä–æ—Ñ–∏–ª—è');
		}
	})
	.catch(error=>{
		console.error('Error:',error);
		alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –ø—Ä–æ—Ñ–∏–ª—è');
	});
}
</script>
</body>
</html>